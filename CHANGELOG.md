# 更新日志

## [1.8.0] - 2025-12-30

### 重构
- 代码模块化重构：将 popup.js 拆分为独立功能模块
  - `constants.js` - 常量和全局状态
  - `utils.js` - 工具函数
  - `storage.js` - 存储管理
  - `ui.js` - 界面渲染（合并 theme.js）
  - `api.js` - API 通信
  - `mail.js` - 临时邮箱
  - `history.js` - 历史记录
  - `archive.js` - 存档管理
  - `form-fill.js` - 表单填充
  - `events.js` - 事件处理

### 新增
- DEBUG 调试开关：生产环境可关闭所有日志输出
- 统一日志系统：`log.info()` / `log.error()` / `log.warn()`
- 统一错误处理函数：`handleError()`
- 按钮加载动画：操作时显示加载状态

### 修复
- 增强字段锁定功能：锁定字段在任何操作下都不会被修改
  - 刷新 IP 时保持锁定字段
  - 重新生成数据时保持锁定字段
  - 加载存档/历史记录时保持锁定字段
  - 切换国家时保持锁定字段

### 优化
- 重构事件处理模块，提取核心处理函数
- 合并 theme.js 到 ui.js，减少文件数量
- 清理重复代码和冗余定义

## [1.7.3] - 2025-12-25

### 新增
- 主界面地址 API 开关 🗺️（快速切换是否使用 API 获取真实地址）

### 修复
- 修复地址 API 返回后州省和邮编未更新的问题
- 修复刷新 IP 后州省字段为空的问题

## [1.7.2] - 2025-12-25

### 新增
- OpenStreetMap Nominatim 地址 API 支持（免费，无需 Key）
- 智能地址切换：优先 Geoapify → 备用 OSM → 本地生成
- Toast 提示显示地址来源（Geoapify / OSM / 本地）

## [1.7.1] - 2025-12-25

### 新增
- Geoapify 地址 API 支持（可生成真实有效的地址，免费 3000次/天）

### 修复
- 修复 `geoapifyApiKey` 变量重复声明导致扩展无法正常工作的问题
- 优化地址生成逻辑，确保地址与城市/州/邮编数据一致

## [1.7.0] - 2025-12-23

### 新增
- AI 模式开关（主界面快速切换）
- Geoapify API 支持（可生成真实有效地址）
- 历史记录功能（保存最近 10 组数据）
- 配置存档功能

### 优化
- 密码生成器支持自定义复杂度
- 优化日本电话号码生成逻辑
- 改进表单字段识别

## [1.6.0] - 2025-12-20

### 新增
- 日本特有数据支持（汉字/片假名姓名、日本地址格式）
- Smart Fill 智能填写功能
- 临时邮箱集成 (Mail.tm)

### 优化
- 改进多国电话号码格式
- 优化密码生成规则
